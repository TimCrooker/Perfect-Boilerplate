"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _Utils = require("./Utils");

var _commander = _interopRequireDefault(require("commander"));

var _path = _interopRequireDefault(require("path"));

var _prompts = _interopRequireDefault(require("prompts"));

var _sao = require("sao");

var _chalk = _interopRequireDefault(require("chalk"));

var _package = _interopRequireDefault(require("../package.json"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const generator = _path.default.resolve(__dirname, './');

const cli = async () => {
  /**
   * Get target project-directory
   */
  const program = _commander.default.name(_package.default.name).version(_package.default.version).arguments('<project-directory>').usage(`${_chalk.default.green('<project-directory>')} [options]`).description(_package.default.description).option('-s, --source <source-path>', 'specify a custom source of plugins').option('-d, --debug', 'run the program in debug mode').parse(process.argv);
  /**
   * Check target project-directory exists
   */


  const [projectDir] = program.args; // handle undefined project dir

  if (projectDir === undefined) {
    console.error('No specified project directory');
    process.exit(1);
  }
  /**
   * Get the plugin source directory
   */


  const source = await (0, _Utils.getSource)(program.source);
  let {
    path: sourcePath
  } = source;
  const {
    error: sourceError
  } = source; // error when supplied source doesn't exist

  if (sourceError) {
    console.error(`${_chalk.default.bold`${sourceError}`}`);
    console.log('Source can be a remote git repository or a local path.');
    console.log();
    console.log('You provided:');
    console.log(`${_chalk.default.blueBright(program.source)}`);
    process.exit(1);
  }

  const packTypes = [];
  /**
   * Verify validity and load plugin packs from supplied directory
   */

  if (sourcePath) {
    const pluginPacks = await _Utils.FSHelper.ReadDir(sourcePath); // error when the plugin source contains no plugins

    if (pluginPacks.length === 0) {
      console.log();
      console.error(_chalk.default.red('ERROR: ') + 'The plugin source directory has no plugins');
      console.log();
      process.exit(1);
    } // create a list of all plugin packs and determine if they are valid


    for (const pluginPack of pluginPacks) {
      const pluginDirPath = `${sourcePath}/${pluginPack}`;
      const packIsValid = await _Utils.FSHelper.ValidPluginPack(pluginDirPath);

      if (packIsValid) {
        packTypes.push({
          title: pluginPack,
          value: pluginPack
        });
      } else {
        console.error(_chalk.default.red('ERROR: ') + 'The plugin pack ' + _chalk.default.cyan(pluginPack) + ' at the directory ' + _chalk.default.cyan(pluginDirPath) + ' is invalid');
        console.log();
      }
    } // error when none of the supplied plugin packs are valid


    if (packTypes.length === 0) {
      console.log();
      console.error(_chalk.default.red('ERROR: ') + 'NONE of the supplied plugin packs are valid');
      console.log();
      process.exit(1);
    }
  }
  /**
   * User selects plugin pack to use
   */


  const {
    projectType
  } = await (0, _prompts.default)({
    type: 'select',
    name: 'projectType',
    message: 'Select your project type',
    choices: packTypes
  });
  sourcePath = `${sourcePath}/${projectType}`;
  /**
   * Create and run new SAO instance with above CLI details
   */

  const sao = new _sao.SAO({
    generator,
    outDir: projectDir,
    logLevel: program.debug ? 4 : 1,
    appName: projectDir,
    extras: {
      debug: !!program.debug,
      paths: {
        sourcePath
      }
    }
  });
  await sao.run().catch(err => {
    console.log(`${program.name()} has encountered an error.`);
    console.log();
    console.log(`If you think this is caused by a bug. Please check out:`);
    console.log(_package.default.author);
    console.log();
    console.error('ERROR', err);
    process.exit(1);
  });
};

var _default = cli;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jbGkudHMiXSwibmFtZXMiOlsiZ2VuZXJhdG9yIiwicGF0aCIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJjbGkiLCJwcm9ncmFtIiwiY29tbWFuZGVyIiwibmFtZSIsImN1cnJlbnRQcm9qZWN0IiwidmVyc2lvbiIsImFyZ3VtZW50cyIsInVzYWdlIiwiY2hhbGsiLCJncmVlbiIsImRlc2NyaXB0aW9uIiwib3B0aW9uIiwicGFyc2UiLCJwcm9jZXNzIiwiYXJndiIsInByb2plY3REaXIiLCJhcmdzIiwidW5kZWZpbmVkIiwiY29uc29sZSIsImVycm9yIiwiZXhpdCIsInNvdXJjZSIsInNvdXJjZVBhdGgiLCJzb3VyY2VFcnJvciIsImJvbGQiLCJsb2ciLCJibHVlQnJpZ2h0IiwicGFja1R5cGVzIiwicGx1Z2luUGFja3MiLCJGU0hlbHBlciIsIlJlYWREaXIiLCJsZW5ndGgiLCJyZWQiLCJwbHVnaW5QYWNrIiwicGx1Z2luRGlyUGF0aCIsInBhY2tJc1ZhbGlkIiwiVmFsaWRQbHVnaW5QYWNrIiwicHVzaCIsInRpdGxlIiwidmFsdWUiLCJjeWFuIiwicHJvamVjdFR5cGUiLCJ0eXBlIiwibWVzc2FnZSIsImNob2ljZXMiLCJzYW8iLCJTQU8iLCJvdXREaXIiLCJsb2dMZXZlbCIsImRlYnVnIiwiYXBwTmFtZSIsImV4dHJhcyIsInBhdGhzIiwicnVuIiwiY2F0Y2giLCJlcnIiLCJhdXRob3IiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7OztBQUVBLE1BQU1BLFNBQVMsR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLElBQXhCLENBQWxCOztBQUVBLE1BQU1DLEdBQUcsR0FBRyxZQUEyQjtBQUNyQztBQUNGO0FBQ0E7QUFDRSxRQUFNQyxPQUFPLEdBQUdDLG1CQUNiQyxJQURhLENBQ1JDLGlCQUFlRCxJQURQLEVBRWJFLE9BRmEsQ0FFTEQsaUJBQWVDLE9BRlYsRUFH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NEJBQTlCO0FBQ0FlLElBQUFBLE9BQU8sQ0FBQ08sR0FBUjtBQUNBUCxJQUFBQSxPQUFPLENBQUNPLEdBQVIsQ0FBYSx5REFBYjtBQUNBUCxJQUFBQSxPQUFPLENBQUNPLEdBQVIsQ0FBWXJCLGlCQUFlb0QsTUFBM0I7QUFDQXRDLElBQUFBLE9BQU8sQ0FBQ08sR0FBUjtBQUNBUCxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBYyxPQUFkLEVBQXVCb0MsR0FBdkI7QUFDQTFDLElBQUFBLE9BQU8sQ0FBQ08sSUFBUixDQUFhLENBQWI7QUFDRCxHQVJLLENBQU47QUFTRCxDQXhJRDs7ZUEwSWVwQixHIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRlNIZWxwZXIsIGdldFNvdXJjZSB9IGZyb20gJ0BVdGlscydcclxuaW1wb3J0IGNvbW1hbmRlciBmcm9tICdjb21tYW5kZXInXHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXHJcbmltcG9ydCBwcm9tcHRzIGZyb20gJ3Byb21wdHMnXHJcbmltcG9ydCB7IE9wdGlvbnMsIFNBTyB9IGZyb20gJ3NhbydcclxuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xyXG5cclxuaW1wb3J0IGN1cnJlbnRQcm9qZWN0IGZyb20gJy4uL3BhY2thZ2UuanNvbidcclxuXHJcbmNvbnN0IGdlbmVyYXRvciA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLycpXHJcblxyXG5jb25zdCBjbGkgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcbiAgLyoqXHJcbiAgICogR2V0IHRhcmdldCBwcm9qZWN0LWRpcmVjdG9yeVxyXG4gICAqL1xyXG4gIGNvbnN0IHByb2dyYW0gPSBjb21tYW5kZXJcclxuICAgIC5uYW1lKGN1cnJlbnRQcm9qZWN0Lm5hbWUpXHJcbiAgICAudmVyc2lvbihjdXJyZW50UHJvamVjdC52ZXJzaW9uKVxyXG4gICAgLmFyZ3VtZW50cygnPHByb2plY3QtZGlyZWN0b3J5PicpXHJcbiAgICAudXNhZ2UoYCR7Y2hhbGsuZ3JlZW4oJzxwcm9qZWN0LWRpcmVjdG9yeT4nKX0gW29wdGlvbnNdYClcclxuICAgIC5kZXNjcmlwdGlvbihjdXJyZW50UHJvamVjdC5kZXNjcmlwdGlvbilcclxuICAgIC5vcHRpb24oJy1zLCAtLXNvdXJjZSA8c291cmNlLXBhdGg+JywgJ3NwZWNpZnkgYSBjdXN0b20gc291cmNlIG9mIHBsdWdpbnMnKVxyXG4gICAgLm9wdGlvbignLWQsIC0tZGVidWcnLCAncnVuIHRoZSBwcm9ncmFtIGluIGRlYnVnIG1vZGUnKVxyXG4gICAgLnBhcnNlKHByb2Nlc3MuYXJndilcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgdGFyZ2V0IHByb2plY3QtZGlyZWN0b3J5IGV4aXN0c1xyXG4gICAqL1xyXG4gIGNvbnN0IFtwcm9qZWN0RGlyXSA9IHByb2dyYW0uYXJnc1xyXG5cclxuICAvLyBoYW5kbGUgdW5kZWZpbmVkIHByb2plY3QgZGlyXHJcbiAgaWYgKHByb2plY3REaXIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgY29uc29sZS5lcnJvcignTm8gc3BlY2lmaWVkIHByb2plY3QgZGlyZWN0b3J5JylcclxuICAgIHByb2Nlc3MuZXhpdCgxKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBwbHVnaW4gc291cmNlIGRpcmVjdG9yeVxyXG4gICAqL1xyXG5cclxuICBjb25zdCBzb3VyY2UgPSBhd2FpdCBnZXRTb3VyY2UocHJvZ3JhbS5zb3VyY2UpXHJcblxyXG4gIGxldCB7IHBhdGg6IHNvdXJjZVBhdGggfSA9IHNvdXJjZVxyXG4gIGNvbnN0IHsgZXJyb3I6IHNvdXJjZUVycm9yIH0gPSBzb3VyY2VcclxuXHJcbiAgLy8gZXJyb3Igd2hlbiBzdXBwbGllZCBzb3VyY2UgZG9lc24ndCBleGlzdFxyXG4gIGlmIChzb3VyY2VFcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgJHtjaGFsay5ib2xkYCR7c291cmNlRXJyb3J9YH1gKVxyXG4gICAgY29uc29sZS5sb2coJ1NvdXJjZSBjYW4gYmUgYSByZW1vdGUgZ2l0IHJlcG9zaXRvcnkgb3IgYSBsb2NhbCBwYXRoLicpXHJcbiAgICBjb25zb2xlLmxvZygpXHJcbiAgICBjb25zb2xlLmxvZygnWW91IHByb3ZpZGVkOicpXHJcbiAgICBjb25zb2xlLmxvZyhgJHtjaGFsay5ibHVlQnJpZ2h0KHByb2dyYW0uc291cmNlKX1gKVxyXG4gICAgcHJvY2Vzcy5leGl0KDEpXHJcbiAgfVxyXG5cclxuICBjb25zdCBwYWNrVHlwZXMgPSBbXVxyXG5cclxuICAvKipcclxuICAgKiBWZXJpZnkgdmFsaWRpdHkgYW5kIGxvYWQgcGx1Z2luIHBhY2tzIGZyb20gc3VwcGxpZWQgZGlyZWN0b3J5XHJcbiAgICovXHJcbiAgaWYgKHNvdXJjZVBhdGgpIHtcclxuICAgIGNvbnN0IHBsdWdpblBhY2tzID0gYXdhaXQgRlNIZWxwZXIuUmVhZERpcihzb3VyY2VQYXRoKVxyXG5cclxuICAgIC8vIGVycm9yIHdoZW4gdGhlIHBsdWdpbiBzb3VyY2UgY29udGFpbnMgbm8gcGx1Z2luc1xyXG4gICAgaWYgKHBsdWdpblBhY2tzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygpXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgY2hhbGsucmVkKCdFUlJPUjogJykgKyAnVGhlIHBsdWdpbiBzb3VyY2UgZGlyZWN0b3J5IGhhcyBubyBwbHVnaW5zJ1xyXG4gICAgICApXHJcbiAgICAgIGNvbnNvbGUubG9nKClcclxuICAgICAgcHJvY2Vzcy5leGl0KDEpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gY3JlYXRlIGEgbGlzdCBvZiBhbGwgcGx1Z2luIHBhY2tzIGFuZCBkZXRlcm1pbmUgaWYgdGhleSBhcmUgdmFsaWRcclxuICAgIGZvciAoY29uc3QgcGx1Z2luUGFjayBvZiBwbHVnaW5QYWNrcykge1xyXG4gICAgICBjb25zdCBwbHVnaW5EaXJQYXRoID0gYCR7c291cmNlUGF0aH0vJHtwbHVnaW5QYWNrfWBcclxuXHJcbiAgICAgIGNvbnN0IHBhY2tJc1ZhbGlkID0gYXdhaXQgRlNIZWxwZXIuVmFsaWRQbHVnaW5QYWNrKHBsdWdpbkRpclBhdGgpXHJcblxyXG4gICAgICBpZiAocGFja0lzVmFsaWQpIHtcclxuICAgICAgICBwYWNrVHlwZXMucHVzaCh7XHJcbiAgICAgICAgICB0aXRsZTogcGx1Z2luUGFjayxcclxuICAgICAgICAgIHZhbHVlOiBwbHVnaW5QYWNrLFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcclxuICAgICAgICAgIGNoYWxrLnJlZCgnRVJST1I6ICcpICtcclxuICAgICAgICAgICAgJ1RoZSBwbHVnaW4gcGFjayAnICtcclxuICAgICAgICAgICAgY2hhbGsuY3lhbihwbHVnaW5QYWNrKSArXHJcbiAgICAgICAgICAgICcgYXQgdGhlIGRpcmVjdG9yeSAnICtcclxuICAgICAgICAgICAgY2hhbGsuY3lhbihwbHVnaW5EaXJQYXRoKSArXHJcbiAgICAgICAgICAgICcgaXMgaW52YWxpZCdcclxuICAgICAgICApXHJcbiAgICAgICAgY29uc29sZS5sb2coKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZXJyb3Igd2hlbiBub25lIG9mIHRoZSBzdXBwbGllZCBwbHVnaW4gcGFja3MgYXJlIHZhbGlkXHJcbiAgICBpZiAocGFja1R5cGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygpXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgY2hhbGsucmVkKCdFUlJPUjogJykgKyAnTk9ORSBvZiB0aGUgc3VwcGxpZWQgcGx1Z2luIHBhY2tzIGFyZSB2YWxpZCdcclxuICAgICAgKVxyXG4gICAgICBjb25zb2xlLmxvZygpXHJcbiAgICAgIHByb2Nlc3MuZXhpdCgxKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXNlciBzZWxlY3RzIHBsdWdpbiBwYWNrIHRvIHVzZVxyXG4gICAqL1xyXG5cclxuICBjb25zdCB7IHByb2plY3RUeXBlIH0gPSBhd2FpdCBwcm9tcHRzKHtcclxuICAgIHR5cGU6ICdzZWxlY3QnLFxyXG4gICAgbmFtZTogJ3Byb2plY3RUeXBlJyxcclxuICAgIG1lc3NhZ2U6ICdTZWxlY3QgeW91ciBwcm9qZWN0IHR5cGUnLFxyXG4gICAgY2hvaWNlczogcGFja1R5cGVzLFxyXG4gIH0pXHJcblxyXG4gIHNvdXJjZVBhdGggPSBgJHtzb3VyY2VQYXRofS8ke3Byb2plY3RUeXBlfWBcclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGFuZCBydW4gbmV3IFNBTyBpbnN0YW5jZSB3aXRoIGFib3ZlIENMSSBkZXRhaWxzXHJcbiAgICovXHJcblxyXG4gIGNvbnN0IHNhbyA9IG5ldyBTQU8oe1xyXG4gICAgZ2VuZXJhdG9yLFxyXG4gICAgb3V0RGlyOiBwcm9qZWN0RGlyLFxyXG4gICAgbG9nTGV2ZWw6IHByb2dyYW0uZGVidWcgPyA0IDogMSxcclxuICAgIGFwcE5hbWU6IHByb2plY3REaXIsXHJcbiAgICBleHRyYXM6IHtcclxuICAgICAgZGVidWc6ICEhcHJvZ3JhbS5kZWJ1ZyxcclxuICAgICAgcGF0aHM6IHtcclxuICAgICAgICBzb3VyY2VQYXRoLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9IGFzIE9wdGlvbnMpXHJcblxyXG4gIGF3YWl0IHNhby5ydW4oKS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgJHtwcm9ncmFtLm5hbWUoKX0gaGFzIGVuY291bnRlcmVkIGFuIGVycm9yLmApXHJcbiAgICBjb25zb2xlLmxvZygpXHJcbiAgICBjb25zb2xlLmxvZyhgSWYgeW91IHRoaW5rIHRoaXMgaXMgY2F1c2VkIGJ5IGEgYnVnLiBQbGVhc2UgY2hlY2sgb3V0OmApXHJcbiAgICBjb25zb2xlLmxvZyhjdXJyZW50UHJvamVjdC5hdXRob3IpXHJcbiAgICBjb25zb2xlLmxvZygpXHJcbiAgICBjb25zb2xlLmVycm9yKCdFUlJPUicsIGVycilcclxuICAgIHByb2Nlc3MuZXhpdCgxKVxyXG4gIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsaVxyXG4iXX0=